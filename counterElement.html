<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <style>
        
        h3 {
            color: red;
        }
    </style>
    <h3>I'm a regular h3</h3>
    <div id="container"></div>

    <hello-world heading="waddup">
        Hello from the slot h3
        <span slot="first-slot">Hello from the named slot
    </hello-world>   
    
    <!-- els need a hyphen. custom to name according to scoping -- lut-card -->
    <lut-counter value="10" min="" max="10" >
    </lut-counter>

    <template id='card'>
        <style>
           :host {
               display: flex;
               align-items: center;
               gap: 10px;
           }
           button {
               background-color: #f0be5c;
               color: #000;
               border-radius: 40%;
               padding-inline: 10px;
               padding-block: 5px; 
               border: 1px solid #000;              
           }
        </style>
        <button id="subtract">-</button>
        <h3></h3>
        <button id="add">+</button>
    </template>

    
    <script>
        class Card extends HTMLElement {
            constructor() {
                super();

                // 1. These run when the element is created

                // An shadow that is open, has a root that can be accessed from outside the element. Closed shadows are not accessible from outside the component. An example of a closed shadow is the <video> element. 
                const shadow = this.attachShadow({mode: 'open'});
                const template = document.getElementById('card')
                const clone = template.content.cloneNode(true);
                shadow.appendChild(clone);

                this.valueHeader = this.shadowRoot.querySelector('h3')
                this.valueHeader.innerHTML = this.value;

                this.subtractButton = this.shadowRoot.querySelector("#subtract")
                this.addButton = this.shadowRoot.querySelector("#add")
            }

           

            // 2. Method is called when the element is inserted into the document
            connectedCallback () {
                this.subtractButton.addEventListener('click', this.subtract)
                this.addButton.addEventListener('click', this.add)
            }

            subtract = () => {
                if (this.min && Number(this.value) <= Number(this.min)) {
                    return;
                }
                this.value = Number(this.value) - 1
            }
            add = () => {
                if (this.max && Number(this.value) >= Number(this.max)){
                    return;
                }
                this.value = Number(this.value) + 1
            } 


            // 3b. this method is called when the element is removed from the DOM
            disconnectedCallback () {
                // cleanup
                this.subtractButton.removeEventListener('click', this.subtract)
                this.addButton.removeEventListener('click', this.add)
            }

            // list an array of attributes that should be observed - dynamic / listening   
            static get observedAttributes () {
                return ['value'];
            }

            // 3a. runs when one of the observed attributes changes
            attributeChangedCallback(name, oldVal, newVal) {
                // Where you update the DOM
                this.valueHeader.innerHTML = this.value;
            }

            // called when the element is moved to a new document - rarely used
            adoptedCallback() {}

            get value() {
                return this.getAttribute('value') 
            }

            set value(val) {
                this.setAttribute("value", val)
            }

            get min(){
                return this.getAttribute('min');
            }

            set min(val) {
                this.setAttribute('min', val)
            }

            get max() {
                return this.getAttribute('max')
            }
            set max(val) {
                this.setAttribute('max', val)
            }
            
        }
        // const container = document.getElementById('container')
        
        // clone.addEventListener('click', () => alert('yeo'))
        // container.appendChild(clone);

        // const clone2 = template.content.cloneNode(true);
        // container.appendChild(clone2);
        
        customElements.define("lut-counter", Card);
       
    </script>
</body>
</html>